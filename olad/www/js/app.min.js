/**
* This program is free software; you can redistribute it and/or modify
* it under the terms of the GNU General Public License as published by
* the Free Software Foundation; either version 2 of the License, or
* (at your option) any later version.
*
* This program is distributed in the hope that it will be useful,
* but WITHOUT ANY WARRANTY; without even the implied warranty of
* MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
* GNU Library General Public License for more details.
*
* You should have received a copy of the GNU General Public License
* along with this program; if not, write to the Free Software
* Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA.
*/

angular.module("olaApp",["ngRoute"]).constant("Channels",512).constant("TopValue",255).constant("nul",0).factory("$ola",["$http","nul","Channels",function(a,b,c){"use strict";var d=function(a){var b=[];for(var c in a)b.push(c+"="+a[c]);return b.join("&")},e=function(a){for(var d=0,e=[],f=0;c>f;f++)e[f]=parseInt(a[f]),e[f]>b&&(d=f+1);return e.length=d,"["+e.join(",")+"]"};return{get:{ItemList:function(){return a.get("/json/universe_plugin_list").then(function(a){return a.data})},ServerInfo:function(){return a.get("/json/server_stats").then(function(a){return a.data})},Ports:function(){return a.get("/json/get_ports").then(function(a){return a.data})},PortsId:function(b){return a.get("/json/get_ports?u="+b).then(function(a){return a.data})},InfoPlugin:function(b){return a.get("/json/plugin_info?id="+b).then(function(a){return a.data})},Dmx:function(b){return a.get("/get_dmx?u="+b).then(function(a){return a.data})},UniverseInfo:function(b){return a.get("/json/universe_info?id="+b).then(function(a){return a.data})}},post:{ModifyUniverse:function(b){return a({method:"POST",url:"/modify_universe",data:d(b),headers:{"Content-Type":"application/x-www-form-urlencoded"}}).then(function(a){return a.data})},AddUniverse:function(b){return a({method:"POST",url:"/new_universe",data:d(b),headers:{"Content-Type":"application/x-www-form-urlencoded"}}).then(function(a){return a.data})},Dmx:function(b,c){var f={u:b,d:e(c)};return a({method:"POST",url:"/set_dmx",data:d(f),headers:{"Content-Type":"application/x-www-form-urlencoded"}}).then(function(a){return a.data})}},action:{Shutdown:function(){return a.get("/quit").then(function(a){return a.data})},Reload:function(){return a.get("/reload").then(function(a){return a.data})},ReloadPids:function(){return a.get("/reload_pids").then(function(a){return a.data})}},rdm:{}}}]).controller("menuCtrl",["$scope","$ola",function(a,b){"use strict";a.Items={},a.Info={},b.get.ItemList().then(function(b){a.Items=b}),b.get.ServerInfo().then(function(b){a.Info=b})}]).controller("overviewCtrl",["$scope","$ola","$location",function(a,b,c){"use strict";a.Info={},a.Universes={},b.get.ItemList().then(function(b){a.Universes=b.universes}),b.get.ServerInfo().then(function(b){a.Info=b}),a.Shutdown=function(){b.action.Shutdown().then(function(){})},a.goUniverse=function(a){c.path("/universe/"+a)}}]).controller("addUniverseCtrl",["$scope","$ola",function(a,b){"use strict";a.Ports={},b.get.Ports().then(function(b){a.Ports=b})}]).controller("universeCtrl",["$scope","$ola","$routeParams","$interval","nul","Channels",function(a,b,c,d,e,f){"use strict";a.dmx=[],a.Universe=c.id,d(function(){b.get.Dmx(a.Universe).then(function(b){for(var c=0;f>c;c++)a.dmx[c]="number"==typeof b.dmx[c]?b.dmx[c]:0})},100),a.$on("$destroy",function(){d.cancel()}),a.getColor=function(a){return a>140?"black":"white"}}]).controller("sliderUniverseCtrl",["$scope","$ola","$routeParams","$window","$interval","nul","Channels",function(a,b,c,d,e,f,g){"use strict";a.get=[],a.list=[],a.last=0,a.offset=0,a.send=!1,a.Universe=c.id;for(var h=0;g>h;h++)a.list[h]=h,a.get[h]=0;a.light=function(b){for(h in a.get)a.get[h]=b};e(function(){b.get.Dmx(a.Universe).then(function(b){for(var c=0;c<b.dmx.length;c++)a.get[c]=b.dmx[c];a.send=!0})},1e3);a.getColor=function(a){return a>140?"black":"white"},a.ceil=function(a){return d.Math.ceil(a)},a.$watchCollection("get",function(){a.send&&b.post.Dmx(a.Universe,a.get)}),a.page=function(b){1===b?a.offset+1!=d.Math.ceil(g/a.limit)&&a.offset++:b===f&&a.offset!==f&&a.offset--},a.limit=d.Math.floor(.99*d.innerWidth/66),a.width={width:d.Math.floor(.99*d.innerWidth/a.limit)-52/a.limit+"px"},d.$(d).resize(function(){a.$apply(function(){a.limit=d.Math.floor(.99*d.innerWidth/66),a.width={width:d.Math.floor(.99*d.innerWidth/a.limit)-52/a.limit+"px"}})}),a.$on("$destroy",function(){e.cancel()})}]).controller("keypadUniverseCtrl",["$scope","$ola","$routeParams",function(a,b,c){"use strict";a.Universe=c.id}]).controller("rdmUniverseCtrl",["$scope","$ola","$routeParams",function(a,b,c){"use strict";a.Universe=c.id}]).controller("patchUniverseCtrl",["$scope","$ola","$routeParams",function(a,b,c){"use strict";a.Universe=c.id}]).controller("settingUniverseCtrl",["$scope","$ola","$routeParams",function(a,b,c){"use strict";a.Universe=c.id,a.PortsId={},b.get.PortsId(c.id).then(function(b){a.PortsId=b})}]).controller("infoPlugin",["$scope","$routeParams","$ola","$document","$window",function(a,b,c,d,e){"use strict";c.get.InfoPlugin(b.id).then(function(b){a.active=b.active,a.enabled=b.enabled,a.name=b.name,d.getElementById("description").innerHTML="",b.description.split("\\n").forEach(function(a){d.getElementById("description").innerText+=a,d.getElementById("description").innerHTML+="<br />"}),e.console.log(b)}),a.stateColor=function(a){return a?{"background-color":"green"}:{"background-color":"red"}}}]).controller("infoPlugins",["$scope","$ola","$location",function(a,b,c){"use strict";a.Items={},a.active=[],a.enabled=[],b.get.ItemList().then(function(c){a.Items=c,c.plugins.forEach(function(c){b.get.InfoPlugin(c.id).then(function(b){a.getStyleActive(b.active,c.id),a.getStyleEnabled(b.enabled,c.id)})})}),a.go=function(a){c.path("/plugin/"+a)},a.getStyleActive=function(b,c){a.active[c]=b?{"background-color":"green"}:{"background-color":"red"}},a.getStyleEnabled=function(b,c){a.enabled[c]=b?{"background-color":"green"}:{"background-color":"red"}}}]).config(["$routeProvider",function(a){"use strict";a.when("/",{templateUrl:"/views/overview.html",controller:"overviewCtrl"}).when("/universes/",{templateUrl:"/views/overview-universes.html",controller:"overviewCtrl"}).when("/universe/add",{templateUrl:"/views/add-universe.html",controller:"addUniverseCtrl"}).when("/universe/:id",{templateUrl:"/views/overview-universe.html",controller:"universeCtrl"}).when("/universe/:id/keypad",{templateUrl:"/views/keypad-universe.html",controller:"keypadUniverseCtrl"}).when("/universe/:id/sliders",{templateUrl:"/views/sliders-universe.html",controller:"sliderUniverseCtrl"}).when("/universe/:id/rdm",{templateUrl:"/views/rdm-universe.html",controller:"rdmUniverseCtrl"}).when("/universe/:id/patch",{templateUrl:"/views/patch-universe.html",controller:"patchUniverseCtrl"}).when("/universe/:id/settings",{templateUrl:"/views/settings-universe.html",controller:"settingUniverseCtrl"}).when("/plugins",{templateUrl:"/views/info-plugins.html",controller:"infoPlugins"}).when("/plugin/:id",{templateUrl:"/views/info-plugin.html",controller:"infoPlugin"}).otherwise({redirectTo:"/"})}]).filter("startFrom",function(){"use strict";return function(a,b){return b=parseInt(b),a.slice(b)}});
//# sourceMappingURL=app.min.js.map