[% INCLUDE $licence %]
/*
 * This code has been autogenerated, do not edit
 */

#ifndef [% lib FILTER upper %]_[% module FILTER upper %]_[% name FILTER upper %]_MESSAGES_H
#define [% lib FILTER upper %]_[% module FILTER upper %]_[% name FILTER upper %]_MESSAGES_H

#ifdef __cplusplus
extern "C" {
#endif

#include <stdint.h>

/*
 * opcodes
 */
enum [% lib FILTER lower %]_[% module FILTER lower %]_[% name FILTER lower %]_msg_op_e {
[% FOREACH msg = msgs -%]
  [% lib FILTER upper %]_[% module FILTER upper %]_[% name FILTER upper %]_MSG_[% msg.name FILTER upper %] = 0x[% loop.index() +1 FILTER format("%0.2hx") %],    // [% msg.doc %]
[% END -%]
};

typedef enum [% lib FILTER lower %]_[% module FILTER lower %]_[% name FILTER lower %]_msg_op_e [% lib FILTER lower %]_[% module FILTER lower %]_[% name FILTER lower %]_msg_op;

[% FOREACH msg = msgs -%]

/*
 * [% msg.doc %] struct 
 */
struct [% lib FILTER lower %]_[% module FILTER lower %]_[% name FILTER lower %]_msg_[% msg.name FILTER lower %]_s {
[% FOREACH var = msg.uint32_t -%]
  uint32_t [% var %];
[% END -%]
[% FOREACH var = msg.uint16_t -%]
  uint16_t [% var %];
[% END -%]
[% FOREACH var = msg.uint8_t -%]
  uint8_t [% var %];
[% END -%]
[% FOREACH array = msg.array.uint32_t -%]
  uint32_t [% array.name %][[% array.len %]];
[% END -%]
[% FOREACH array = msg.array.uint16_t -%]
  uint16_t [% array.name %][[% array.len %]];
[% END -%]
[% FOREACH array = msg.array.uint8_t -%]
  uint8_t [% array.name %][[% array.len %]];
[% END -%]
} __attribute__( ( packed ) );

typedef struct [% lib FILTER lower %]_[% module FILTER lower %]_[% name FILTER lower %]_msg_[% msg.name FILTER lower %]_s [% lib FILTER lower %]_[% module FILTER lower %]_[% name FILTER lower %]_msg_[% msg.name FILTER lower %];

[% END -%]

/*
 * union of all the msgs
 */
union [% lib FILTER lower %]_[% module FILTER lower %]_[% name FILTER lower %]_msg_u {
[% FOREACH msg = msgs -%]
    [% lib FILTER lower %]_[% module FILTER lower %]_[% name FILTER lower %]_msg_[% msg.name FILTER lower %] [% msg.name FILTER lower %];
[% END -%]
};


struct [% lib FILTER lower %]_[% module FILTER lower %]_[% name FILTER lower %]_msg_s {
  uint8_t op;
[% FOREACH stat = statics -%]
  [% stat.type %] [% stat.name %];	// [% stat.value %]
[% END -%]
  union [% lib FILTER lower %]_[% module FILTER lower %]_[% name FILTER lower %]_msg_u data;
};

typedef struct [% lib FILTER lower %]_[% module FILTER lower %]_[% name FILTER lower %]_msg_s [% lib FILTER lower %]_[% module FILTER lower %]_[% name FILTER lower %]_msg;

const int [% lib FILTER lower %]_[% module FILTER lower %]_[% name FILTER lower %]_header_size = sizeof([% lib FILTER lower %]_[% module FILTER lower %]_[% name FILTER lower %]_msg) - sizeof(union [% lib FILTER lower %]_[% module FILTER lower %]_[% name FILTER lower %]_msg_u);
#ifdef __cplusplus
}
#endif

#endif
